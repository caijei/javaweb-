{"remainingRequest":"D:\\10000\\java\\82、酒店管理系统\\HotelManager\\HotelManager\\HotelManagerUserVue\\node_modules\\babel-loader\\lib\\index.js!D:\\10000\\java\\82、酒店管理系统\\HotelManager\\HotelManager\\HotelManagerUserVue\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\10000\\java\\82、酒店管理系统\\HotelManager\\HotelManager\\HotelManagerUserVue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\10000\\java\\82、酒店管理系统\\HotelManager\\HotelManager\\HotelManagerUserVue\\src\\views\\reservation-custom.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\10000\\java\\82、酒店管理系统\\HotelManager\\HotelManager\\HotelManagerUserVue\\src\\views\\reservation-custom.vue","mtime":1698855378199},{"path":"D:\\10000\\java\\82、酒店管理系统\\HotelManager\\HotelManager\\HotelManagerUserVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678514552181},{"path":"D:\\10000\\java\\82、酒店管理系统\\HotelManager\\HotelManager\\HotelManagerUserVue\\node_modules\\babel-loader\\lib\\index.js","mtime":1678514552606},{"path":"D:\\10000\\java\\82、酒店管理系统\\HotelManager\\HotelManager\\HotelManagerUserVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678514552181},{"path":"D:\\10000\\java\\82、酒店管理系统\\HotelManager\\HotelManager\\HotelManagerUserVue\\node_modules\\vue-loader\\lib\\index.js","mtime":1678514554361}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.date.to-string\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport footbar from \"@/components/footbar.vue\";\nexport default {\n  data: function data() {\n    return {\n      resinfo: {\n        id: \"\",\n        type: \"\",\n        indate: \"\",\n        leavedate: \"\",\n        num: \"\",\n        isNeedInvoice: false\n      },\n      price: 0,\n      sumprice: 0,\n      maxp: 1,\n      lockCondition: false,\n      isNotSelect: true,\n      checkBtnDis: false,\n      searchicon: \"el-icon-a-042\",\n      searchBtnType: \"primary\",\n      dialogVisible: false,\n      roomnumber: [],\n      roomtype: [],\n      rules: {\n        type: [{\n          required: true,\n          message: \"请选择房间类型\",\n          trigger: \"change\"\n        }],\n        id: [{\n          required: true,\n          message: \"请选择房间号\",\n          trigger: \"change\"\n        }],\n        indate: [{\n          type: \"date\",\n          required: true,\n          message: \"请选择入住时间\",\n          trigger: \"change\"\n        }],\n        leavedate: [{\n          type: \"date\",\n          required: true,\n          message: \"请选择离店时间\",\n          trigger: \"change\"\n        }]\n      }\n    };\n  },\n  components: {\n    footbar: footbar\n  },\n  methods: {\n    submitForm: function submitForm(formName) {\n      this.dialogVisible = true;\n    },\n    resetForm: function resetForm(formName) {\n      this.checkBtnDis = false;\n      this.searchicon = \"el-icon-a-042\";\n      this.searchBtnType = \"primary\";\n      this.isNotSelect = true;\n      this.price = 0;\n      this.sumprice = 0;\n      this.resinfo.isNeedInvoice = false;\n      this.$refs[formName].resetFields();\n    },\n    oktest: function oktest() {\n      this.$router.push(\"/submitok\");\n    },\n    failtest: function failtest() {\n      this.$router.push(\"/submitfail\");\n    },\n    confirmSubmitForm: function confirmSubmitForm() {\n      var _this = this;\n\n      this.dialogVisible = false;\n\n      if (this.resinfo.id == undefined || this.resinfo.id == \"\" || this.resinfo.id == null) {\n        alert(\"请选择房间号\");\n        return;\n      }\n\n      var json = {\n        roomId: parseInt(this.resinfo.id),\n        inTime: this.changeTimeStr(this.resinfo.indate),\n        leaveTime: this.changeTimeStr(this.resinfo.leavedate),\n        realPeople: this.resinfo.num,\n        fapiao: this.fapiao\n      };\n      this.axios.post(\"http://localhost:9151/user/bookRoom\", json).then(function (res) {\n        if (res.data.code != \"200\") {\n          _this.$message({\n            message: \"登录信息过期\",\n            type: \"error\"\n          });\n\n          _this.$router.push(\"/\");\n        } else {\n          _this.$router.push(\"/submitok\");\n        }\n      }).catch(function (res) {\n        _this.$router.push(\"/submitfail\");\n      });\n    },\n    resolveData: function resolveData() {\n      var _this2 = this;\n\n      // console.log(123123);\n      this.axios.get(\"http://localhost:9151/user/listTypes\").then(function (res) {\n        _this2.roomtype = res.data.data; // console.log(this.roomtype);\n      }).catch(function () {\n        console.log(\"error\");\n      });\n    },\n    checkroom: function checkroom() {\n      var _this3 = this;\n\n      this.checkBtnDis = true;\n      this.searchicon = \"el-icon-loading\";\n      this.axios.post(\"http://localhost:9151/user/listRoomsByTypeId\", {\n        typeId: this.resinfo.type,\n        inTime: this.changeTimeStr(this.resinfo.indate),\n        leaveTime: this.changeTimeStr(this.resinfo.leavedate)\n      }).then(function (res) {\n        _this3.roomnumber = res.data.data;\n        _this3.searchicon = \"el-icon-check\";\n        _this3.searchBtnType = \"success\";\n        _this3.isNotSelect = false;\n        _this3.lockCondition = true;\n        _this3.price = _this3.roomnumber[0].type.price;\n        _this3.maxp = _this3.roomnumber[0].maxPeople;\n\n        _this3.calcPrice();\n      }).catch(function () {\n        _this3.searchicon = \"el-icon-close\";\n        _this3.searchBtnType = \"danger\";\n        console.log(\"error\");\n      });\n    },\n    changeTimeStr: function changeTimeStr(str) {\n      str = str.toString();\n      str = str.replace(/ GMT.+$/, \"\"); // Or str = str.substring(0, 24)\n\n      var d = new Date(str);\n      var a = [d.getFullYear(), d.getMonth() + 1, d.getDate(), d.getHours(), d.getMinutes(), d.getSeconds()];\n\n      for (var i = 0, len = a.length; i < len; i++) {\n        if (a[i] < 10) {\n          a[i] = \"0\" + a[i];\n        }\n      }\n\n      str = a[0] + \"-\" + a[1] + \"-\" + a[2] + \" \" + a[3] + \":\" + a[4];\n      return str;\n    },\n    calcPrice: function calcPrice() {\n      var realday = Math.abs(this.resinfo.leavedate - this.resinfo.indate) / 86400000;\n      console.log(Math.ceil(realday));\n      realday = Math.ceil(realday);\n      var price = this.price;\n      this.sumprice = price * realday;\n      console.log(this.sumprice, price, realday);\n    }\n  },\n  mounted: function mounted() {\n    this.resolveData();\n  },\n  computed: {\n    fapiao: function fapiao() {\n      if (this.resinfo.isNeedInvoice == true) return 1;else return 0;\n    }\n  }\n};",{"version":3,"sources":["reservation-custom.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n    <div>\r\n        <el-container class=\"wrapper\">\r\n            <el-main class=\"section text-left\">\r\n                <div class=\"res-bg\"></div>\r\n                <el-card class=\"box-card res-form\">\r\n                    <div slot=\"header\" class=\"clearfix\">\r\n                        <span>预订客房</span>\r\n                    </div>\r\n                    <div class=\"text item\">\r\n                        <el-form\r\n                            :model=\"resinfo\"\r\n                            :rules=\"rules\"\r\n                            ref=\"ruleForm\"\r\n                            label-width=\"80px\"\r\n                            class=\"demo-ruleForm\"\r\n                        >\r\n                            <el-form-item\r\n                                label=\"客房类型\"\r\n                                prop=\"type\"\r\n                                required\r\n                                @click=\"resolveData\"\r\n                            >\r\n                                <el-select\r\n                                    v-model=\"resinfo.type\"\r\n                                    placeholder=\"请选择\"\r\n                                    :disabled=\"lockCondition\"\r\n                                >\r\n                                    <el-option\r\n                                        v-for=\"item in roomtype\"\r\n                                        :key=\"item.id\"\r\n                                        :label=\"item.typeName\"\r\n                                        :value=\"item.id\"\r\n                                    >\r\n                                    </el-option>\r\n                                </el-select>\r\n                            </el-form-item>\r\n\r\n                            <el-form-item label=\"入住时间\" required>\r\n                                <el-col :span=\"24\" class=\"mb-1\">\r\n                                    <el-form-item prop=\"indate\">\r\n                                        <el-date-picker\r\n                                            :disabled=\"lockCondition\"\r\n                                            type=\"datetime\"\r\n                                            placeholder=\"入住日期\"\r\n                                            v-model=\"resinfo.indate\"\r\n                                            style=\"width: 100%\"\r\n                                        >\r\n                                        </el-date-picker>\r\n                                    </el-form-item>\r\n                                </el-col>\r\n                                <!-- <el-col class=\"line text-center\" :span=\"24\">至</el-col> -->\r\n                                <el-col :span=\"24\">\r\n                                    <el-form-item prop=\"leavedate\">\r\n                                        <el-date-picker\r\n                                            :disabled=\"lockCondition\"\r\n                                            type=\"datetime\"\r\n                                            placeholder=\"离店日期\"\r\n                                            v-model=\"resinfo.leavedate\"\r\n                                            style=\"width: 100%\"\r\n                                        >\r\n                                        </el-date-picker>\r\n                                    </el-form-item>\r\n                                </el-col>\r\n                            </el-form-item>\r\n\r\n                            <el-form-item>\r\n                                <el-button\r\n                                    :type=\"searchBtnType\"\r\n                                    @click=\"checkroom\"\r\n                                    :disabled=\"checkBtnDis\"\r\n                                >\r\n                                    <i\r\n                                        :class=\"searchicon\"\r\n                                        style=\"font-size: 18px\"\r\n                                    ></i>\r\n                                     查询可用房间\r\n                                </el-button>\r\n                            </el-form-item>\r\n\r\n                            <!-- 提供一个房间号码对房间id的映射，即用户选择的是房间号，但存的是房间id -->\r\n                            <el-form-item label=\"房间号码\" prop=\"id\" required>\r\n                                <el-select\r\n                                    v-model=\"resinfo.id\"\r\n                                    placeholder=\"请先选择房间号\"\r\n                                    :disabled=\"isNotSelect\"\r\n                                >\r\n                                    <el-option\r\n                                        v-for=\"item in roomnumber\"\r\n                                        :key=\"item.id\"\r\n                                        :label=\"item.number\"\r\n                                        :value=\"item.id\"\r\n                                    >\r\n                                    </el-option>\r\n                                </el-select>\r\n                            </el-form-item>\r\n\r\n                            <el-form-item label=\"住店人数\" prop=\"num\" required>\r\n                                <el-input-number\r\n                                    v-model=\"resinfo.num\"\r\n                                    :min=\"1\"\r\n                                    :max=\"maxp\"\r\n                                    label=\"请输入\"\r\n                                    :disabled=\"isNotSelect\"\r\n                                ></el-input-number>\r\n                                <span class=\"ml-1\">人</span>\r\n                            </el-form-item>\r\n                            <el-form-item label=\"提供发票\" prop=\"invoice\">\r\n                                <el-switch\r\n                                    v-model=\"resinfo.isNeedInvoice\"\r\n                                    :disabled=\"isNotSelect\"\r\n                                ></el-switch>\r\n                            </el-form-item>\r\n                            <el-form-item label=\"价格\">\r\n                                <span v-model=\"resinfo.type\" class=\"room-price\"\r\n                                    >{{ sumprice }} 元</span\r\n                                >\r\n                            </el-form-item>\r\n                            <el-form-item>\r\n                                <el-button\r\n                                    type=\"primary\"\r\n                                    @click=\"submitForm('ruleForm')\"\r\n                                    style=\"font-size: 22px\"\r\n                                    :disabled=\"isNotSelect\"\r\n                                >\r\n                                    立即预订\r\n                                </el-button>\r\n                                <br />\r\n                                <el-button\r\n                                    @click=\"resetForm('ruleForm')\"\r\n                                    type=\"warning\"\r\n                                    style=\"font-size: 22px\"\r\n                                >\r\n                                    重置选项\r\n                                </el-button>\r\n                            </el-form-item>\r\n                        </el-form>\r\n                    </div>\r\n                </el-card>\r\n                <!--        <el-button type=\"success\" @click=\"oktest\">预订成功测试</el-button>\r\n        <el-button type=\"danger\" @click=\"failtest\">预订失败测试</el-button> -->\r\n            </el-main>\r\n            <el-footer class=\"footer\">\r\n                <footbar></footbar>\r\n            </el-footer>\r\n\r\n            <el-dialog title=\"提示\" :visible.sync=\"dialogVisible\" width=\"95%\">\r\n                <span>你确定要提交预订单吗？</span>\r\n                <span slot=\"footer\" class=\"dialog-footer\">\r\n                    <el-button @click=\"dialogVisible = false\" style=\"font-size: 18px;\"> 取消</el-button>\r\n                    <el-button type=\"primary\" @click=\"confirmSubmitForm\"\r\n                        >确定</el-button\r\n                    >\r\n                </span>\r\n            </el-dialog>\r\n        </el-container>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport footbar from \"@/components/footbar.vue\";\r\nexport default {\r\n    data() {\r\n        return {\r\n            resinfo: {\r\n                id: \"\",\r\n                type: \"\",\r\n                indate: \"\",\r\n                leavedate: \"\",\r\n                num: \"\",\r\n                isNeedInvoice: false,\r\n            },\r\n            price: 0,\r\n            sumprice: 0,\r\n            maxp: 1,\r\n            lockCondition: false,\r\n            isNotSelect: true,\r\n            checkBtnDis: false,\r\n            searchicon: \"el-icon-a-042\",\r\n            searchBtnType: \"primary\",\r\n            dialogVisible: false,\r\n            roomnumber: [],\r\n            roomtype: [],\r\n            rules: {\r\n                type: [\r\n                    {\r\n                        required: true,\r\n                        message: \"请选择房间类型\",\r\n                        trigger: \"change\",\r\n                    },\r\n                ],\r\n                id: [\r\n                    {\r\n                        required: true,\r\n                        message: \"请选择房间号\",\r\n                        trigger: \"change\",\r\n                    },\r\n                ],\r\n                indate: [\r\n                    {\r\n                        type: \"date\",\r\n                        required: true,\r\n                        message: \"请选择入住时间\",\r\n                        trigger: \"change\",\r\n                    },\r\n                ],\r\n                leavedate: [\r\n                    {\r\n                        type: \"date\",\r\n                        required: true,\r\n                        message: \"请选择离店时间\",\r\n                        trigger: \"change\",\r\n                    },\r\n                ],\r\n            },\r\n        };\r\n    },\r\n    components: {\r\n        footbar,\r\n    },\r\n    methods: {\r\n        submitForm(formName) {\r\n            this.dialogVisible = true;\r\n        },\r\n        resetForm(formName) {\r\n            this.checkBtnDis = false;\r\n            this.searchicon = \"el-icon-a-042\";\r\n            this.searchBtnType = \"primary\";\r\n            this.isNotSelect = true;\r\n            this.price = 0;\r\n            this.sumprice = 0;\r\n            this.resinfo.isNeedInvoice = false;\r\n            this.$refs[formName].resetFields();\r\n        },\r\n        oktest() {\r\n            this.$router.push(\"/submitok\");\r\n        },\r\n        failtest() {\r\n            this.$router.push(\"/submitfail\");\r\n        },\r\n        confirmSubmitForm() {\r\n            this.dialogVisible = false;\r\n            if (\r\n                this.resinfo.id == undefined ||\r\n                this.resinfo.id == \"\" ||\r\n                this.resinfo.id == null\r\n            ) {\r\n                alert(\"请选择房间号\");\r\n                return;\r\n            }\r\n            let json = {\r\n                roomId: parseInt(this.resinfo.id),\r\n                inTime: this.changeTimeStr(this.resinfo.indate),\r\n                leaveTime: this.changeTimeStr(this.resinfo.leavedate),\r\n                realPeople: this.resinfo.num,\r\n                fapiao: this.fapiao,\r\n            };\r\n            this.axios\r\n                .post(\"http://localhost:9151/user/bookRoom\", json)\r\n                .then((res) => {\r\n                    if (res.data.code != \"200\") {\r\n                        this.$message({\r\n                            message: \"登录信息过期\",\r\n                            type: \"error\",\r\n                        });\r\n                        this.$router.push(\"/\");\r\n                    } else {\r\n                        this.$router.push(\"/submitok\");\r\n                    }\r\n                })\r\n                .catch((res) => {\r\n                    this.$router.push(\"/submitfail\");\r\n                });\r\n        },\r\n        resolveData() {\r\n            // console.log(123123);\r\n            this.axios\r\n                .get(\"http://localhost:9151/user/listTypes\")\r\n                .then((res) => {\r\n                    this.roomtype = res.data.data;\r\n                    // console.log(this.roomtype);\r\n                })\r\n                .catch(() => {\r\n                    console.log(\"error\");\r\n                });\r\n        },\r\n        checkroom() {\r\n            this.checkBtnDis = true;\r\n            this.searchicon = \"el-icon-loading\";\r\n            this.axios\r\n                .post(\"http://localhost:9151/user/listRoomsByTypeId\", {\r\n                    typeId: this.resinfo.type,\r\n                    inTime: this.changeTimeStr(this.resinfo.indate),\r\n                    leaveTime: this.changeTimeStr(this.resinfo.leavedate),\r\n                })\r\n                .then((res) => {\r\n                    this.roomnumber = res.data.data;\r\n                    this.searchicon = \"el-icon-check\";\r\n                    this.searchBtnType = \"success\";\r\n                    this.isNotSelect = false;\r\n                    this.lockCondition = true;\r\n                    this.price = this.roomnumber[0].type.price;\r\n                    this.maxp = this.roomnumber[0].maxPeople;\r\n                    this.calcPrice();\r\n                })\r\n                .catch(() => {\r\n                    this.searchicon = \"el-icon-close\";\r\n                    this.searchBtnType = \"danger\";\r\n                    console.log(\"error\");\r\n                });\r\n        },\r\n        changeTimeStr(str) {\r\n            str = str.toString();\r\n            str = str.replace(/ GMT.+$/, \"\"); // Or str = str.substring(0, 24)\r\n            let d = new Date(str);\r\n            let a = [\r\n                d.getFullYear(),\r\n                d.getMonth() + 1,\r\n                d.getDate(),\r\n                d.getHours(),\r\n                d.getMinutes(),\r\n                d.getSeconds(),\r\n            ];\r\n            for (var i = 0, len = a.length; i < len; i++) {\r\n                if (a[i] < 10) {\r\n                    a[i] = \"0\" + a[i];\r\n                }\r\n            }\r\n            str = a[0] + \"-\" + a[1] + \"-\" + a[2] + \" \" + a[3] + \":\" + a[4];\r\n            return str;\r\n        },\r\n        calcPrice() {\r\n            let realday =\r\n                Math.abs(this.resinfo.leavedate - this.resinfo.indate) /\r\n                86400000;\r\n            console.log(Math.ceil(realday));\r\n            realday = Math.ceil(realday);\r\n            let price = this.price;\r\n            this.sumprice = price * realday;\r\n            console.log(this.sumprice, price, realday);\r\n        },\r\n    },\r\n    mounted() {\r\n        this.resolveData();\r\n    },\r\n    computed: {\r\n        fapiao() {\r\n            if (this.resinfo.isNeedInvoice == true) return 1;\r\n            else return 0;\r\n        },\r\n    },\r\n};\r\n</script>\r\n\r\n<style scoped=\"scoped\">\r\n.res-bg {\r\n    background: url(../assets/img/reservation.jpg);\r\n    background-size: cover;\r\n    height: 30vh;\r\n    border: 0px solid transparent;\r\n    border-bottom-left-radius: 10px;\r\n    border-bottom-right-radius: 10px;\r\n}\r\n\r\n.text {\r\n    font-size: 14px;\r\n}\r\n\r\n.item {\r\n    padding: 9px 0;\r\n}\r\n\r\n.res-form {\r\n    margin: -5rem 1rem 1rem 1rem;\r\n}\r\n\r\n/* .el-card__body {\r\n    padding: 20px 20px 20px 0px;\r\n  } */\r\n\r\n.el-select {\r\n    width: 100%;\r\n}\r\n\r\n.room-price {\r\n    font-size: 1.3rem;\r\n    color: #f56c6c;\r\n}\r\n</style>\r\n"],"sourceRoot":"src/views"}]}